<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Beijos Gloss üíã - Carrinho</title>

  <!-- =============================== -->
  <!-- üìå IMPORTA√á√ÉO DE FONTES -->
  <!-- =============================== -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>

  <!-- =============================== -->
  <!-- üîô BOT√ÉO VOLTAR √Ä LOJA -->
  <!-- =============================== -->
  <a href="/html/inicio.html" class="botao-voltar">‚Üê Voltar √† loja</a>

  <style>
    /* =============================== */
    /* üî¥ ESTILO DO BOT√ÉO VOLTAR */
    /* =============================== */
    .botao-voltar {
      display: inline-block;
      margin-top: 30px;
      background-color: #b30000;
      color: white;
      padding: 10px 18px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }
    .botao-voltar:hover {
      background-color: #800000;
    }

    /* =============================== */
    /* üü£ ESTILO GLOBAL DA P√ÅGINA */
    /* =============================== */
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: #fff0f5;
      color: #4d0000;
      padding-bottom: 80px; /* espa√ßo para footer fixo */
    }

    /* =============================== */
    /* üü† CABE√áALHO */
    /* =============================== */
    header {
      background-color: #b30000;
      color: white;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      font-family: 'Great Vibes', cursive;
      font-size: 3em;
      margin: 0;
    }

    /* =============================== */
    /* üü¢ CONTAINER PRINCIPAL */
    /* =============================== */
    .container {
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 0 20px #ffd6e8;
    }

    h2 {
      color: #b30000;
      margin-bottom: 20px;
      text-align: center;
    }

    /* =============================== */
    /* üîµ ITENS DO CARRINHO */
    /* =============================== */
    .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }
    .item span {
      flex: 1;
    }
    .item button {
      background: transparent;
      border: none;
      color: red;
      font-size: 18px;
      cursor: pointer;
      margin-left: 10px;
    }

    /* =============================== */
    /* üü° RESUMO DO CARRINHO */
    /* =============================== */
    .total, .frete, .desconto {
      text-align: right;
      font-size: 1.1em;
      font-weight: bold;
      margin-top: 15px;
      color: #800000;
    }

    /* =============================== */
    /* üü† BOTOES LIMPAR/FINALIZAR */
    /* =============================== */
    .botoes {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
      flex-wrap: wrap;
      gap: 10px;
    }
    button, select {
      padding: 10px 20px;
      background-color: #b30000;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1em;
      cursor: pointer;
    }
    button:hover {
      background-color: #800000;
    }

    /* =============================== */
    /* üü£ INPUTS E LABELS */
    /* =============================== */
    input {
      padding: 10px;
      width: 100%;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    label {
      font-weight: bold;
      color: #b30000;
      display: block;
    }

    /* =============================== */
    /* üü¢ PAGAMENTO (INICIALMENTE ESCONDIDO) */
    /* =============================== */
    #pagamento {
      display: none;
      margin-top: 40px;
      padding-top: 30px;
      border-top: 2px dashed #ffcce0;
    }

    /* =============================== */
    /* üîµ MENSAGEM DE SUCESSO */
    /* =============================== */
    .success-msg {
      text-align: center;
      font-size: 20px;
      color: green;
      margin-top: 30px;
    }

    /* =============================== */
    /* üü° FOOTER FIXO */
    /* =============================== */
    footer {
      background-color: #800000;
      color: white;
      text-align: center;
      padding: 20px;
      position: fixed;
      bottom: 0;
      width: 100%;
    }

    /* =============================== */
    /* üü† SE√á√ÉO DE PRODUTOS */
    /* =============================== */
    .produtos {
      margin: 30px 0;
    }
    .produto {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: #fff5f8;
      border-radius: 10px;
      margin-bottom: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    .produto h3 {
      margin: 0;
      color: #b30000;
    }

  </style>
</head>
<body>

  <!-- =============================== -->
  <!-- üî¥ CABE√áALHO -->
  <!-- =============================== -->
  <header>
    <h1>Beijos Gloss üíã</h1>
  </header>

  <!-- =============================== -->
  <!-- üü¢ CONTAINER PRINCIPAL -->
  <!-- =============================== -->
  <div class="container">
    <!-- Se√ß√£o de Produtos -->
    <h2>‚ú® Produtos</h2>
    <div class="produtos">
      <!-- Cada produto possui bot√£o para adicionar ao carrinho -->
      <div class="produto">
        <h3>Gloss Nude Elegance</h3>
        <span>R$ 29,90</span>
        <button onclick="adicionarAoCarrinho('Gloss Nude Elegance', 29.90)">Adicionar</button>
      </div>
      <div class="produto">
        <h3>Gloss Rosa Quartz</h3>
        <span>R$ 34,90</span>
        <button onclick="adicionarAoCarrinho('Gloss Rosa Quartz', 34.90)">Adicionar</button>
      </div>
      <div class="produto">
        <h3>Gloss Cristal</h3>
        <span>R$ 24,90</span>
        <button onclick="adicionarAoCarrinho('Gloss Cristal', 24.90)">Adicionar</button>
      </div>
      <div class="produto">
        <h3>Gloss Sedutor</h3>
        <span>R$ 39,90</span>
        <button onclick="adicionarAoCarrinho('Gloss Sedutor', 39.90)">Adicionar</button>
      </div>
    </div>

    <!-- Carrinho -->
    <h2>Meu Carrinho üõçÔ∏è</h2>
    <div id="carrinho-itens"></div>
    <div class="total" id="subtotal"></div>

    <!-- Frete e cupom -->
    <label for="frete">Escolha o frete:</label>
    <select id="frete" onchange="atualizarTotal()">
      <option value="10">PAC - R$ 10,00</option>
      <option value="19.9">Sedex - R$ 19,90</option>
    </select>

    <label for="cupom">Cupom de desconto:</label>
    <input type="text" id="cupom" placeholder="Digite seu cupom" oninput="atualizarTotal()" />

    <div class="desconto" id="desconto-info"></div>
    <div class="frete" id="frete-info"></div>
    <div class="total" id="total"></div>

    <!-- Bot√µes -->
    <div class="botoes">
      <button onclick="limparCarrinho()">Limpar Carrinho</button>
      <button onclick="mostrarPagamento()">Finalizar Compra</button>
    </div>

    <!-- =============================== -->
    <!-- üü£ PAGAMENTO -->
    <!-- =============================== -->
    <div id="pagamento">
      <h2>Pagamento</h2>

      <!-- Sele√ß√£o do m√©todo -->
      <label for="metodo">M√©todo de Pagamento:</label>
      <select id="metodo" onchange="mostrarMetodo()">
        <option value="cartao">Cart√£o de Cr√©dito</option>
        <option value="pix">Pix</option>
        <option value="boleto">Boleto</option>
      </select>

      <form id="formPagamento" onsubmit="finalizarCompra(event)">
        <!-- Cart√£o -->
        <div id="pag-cartao">
          <label for="nome">Nome no Cart√£o:</label>
          <input type="text" id="nome">
          <label for="numero">N√∫mero do Cart√£o:</label>
          <input type="text" id="numero" maxlength="16">
          <label for="validade">Validade (MM/AA):</label>
          <input type="text" id="validade" maxlength="5">
          <label for="cvv">CVV:</label>
          <input type="text" id="cvv" maxlength="3">
        </div>

        <!-- Pix -->
        <div id="pag-pix" style="display:none;">
          <p>Escaneie o QR Code ou use a chave:</p>
          <p><strong>pix@beijosgloss.com</strong></p>
        </div>

        <!-- Boleto -->
        <div id="pag-boleto" style="display:none;">
          <p>Seu boleto ser√° gerado ap√≥s a finaliza√ß√£o.</p>
        </div>

        <button type="submit">Pagar Agora</button>
      </form>

      <!-- Mensagem de confirma√ß√£o -->
      <div id="mensagem" class="success-msg"></div>
    </div>
  </div>

  <footer>
    <p>&copy; 2025 Beijos Gloss. Todos os direitos reservados.</p>
  </footer>

  <!-- =============================== -->
  <!-- üíª JAVASCRIPT COMENTADO VISUAL -->
  <!-- =============================== -->
  <script>
    // üî¥ Vari√°veis globais
    let totalCarrinho = 0;
    let valorFrete = 10;
    let desconto = 0;

    // üü¢ Fun√ß√£o para carregar o carrinho
    function carregarCarrinho() {
      const carrinhoItens = document.getElementById("carrinho-itens");
      const subtotalEl = document.getElementById("subtotal");
      let carrinho = JSON.parse(localStorage.getItem("carrinho") || "[]");

      if (carrinho.length === 0) {
        carrinhoItens.innerHTML = "<p>Seu carrinho est√° vazio üò¢</p>";
        subtotalEl.innerHTML = "";
        return;
      }

      // üîµ Agrupa produtos iguais
      const agrupado = {};
      carrinho.forEach(item => {
        if (!agrupado[item.nome]) {
          agrupado[item.nome] = { ...item, quantidade: 1 };
        } else {
          agrupado[item.nome].quantidade++;
        }
      });

      let html = "";
      totalCarrinho = 0;

      for (let nome in agrupado) {
        const item = agrupado[nome];
        const subtotal = item.preco * item.quantidade;
        totalCarrinho += subtotal;
        html += `
          <div class="item">
            <span>${nome} (x${item.quantidade})</span>
            <span>R$ ${subtotal.toFixed(2)}</span>
            <button onclick="removerItem('${nome}')">‚ùå</button>
          </div>`;
      }

      carrinhoItens.innerHTML = html;
      subtotalEl.innerHTML = `Subtotal: R$ ${totalCarrinho.toFixed(2)}`;
      atualizarTotal();
    }

    // üü° Adiciona item ao carrinho
    function adicionarAoCarrinho(nome, preco) {
      let carrinho = JSON.parse(localStorage.getItem("carrinho") || "[]");
      carrinho.push({ nome, preco });
      localStorage.setItem("carrinho", JSON.stringify(carrinho));
      carregarCarrinho();
      alert(`${nome} foi adicionado ao carrinho! üíñ`);
    }

    // üîµ Remove apenas 1 item
    function removerItem(nome) {
      let carrinho = JSON.parse(localStorage.getItem("carrinho") || "[]");
      const index = carrinho.findIndex(item => item.nome === nome);
      if (index !== -1) carrinho.splice(index, 1);
      localStorage.setItem("carrinho", JSON.stringify(carrinho));
      carregarCarrinho();
    }

    // üü¢ Atualiza total com frete e cupom
    function atualizarTotal() {
      let cupom = document.getElementById("cupom").value.trim().toUpperCase();
      valorFrete = parseFloat(document.getElementById("frete").value);
      desconto = 0;
      let freteTexto = `Frete: R$ ${valorFrete.toFixed(2)}`;

      if (cupom === "BEIJOS10") desconto = totalCarrinho * 0.10;
      else if (cupom === "FRETEGRATIS") {
        valorFrete = 0;
        freteTexto = `Frete gr√°tis com cupom!`;
      }

      if (totalCarrinho >= 100 && cupom === "") {
        valorFrete = 0;
        freteTexto = "Frete gr√°tis acima de R$ 100,00!";
      }

      document.getElementById("desconto-info").innerText = desconto > 0 ? `Desconto: -R$ ${desconto.toFixed(2)}` : "";
      document.getElementById("frete-info").innerText = freteTexto;

      const totalFinal = totalCarrinho + valorFrete - desconto;
      document.getElementById("total").innerText = `Total: R$ ${totalFinal.toFixed(2)}`;
    }

    // üü° Limpar carrinho
    function limparCarrinho() {
      localStorage.removeItem("carrinho");
      carregarCarrinho();
      alert("Carrinho limpo! üßπ");
    }

    // üü£ Mostrar pagamento
    function mostrarPagamento() {
      document.getElementById("pagamento").style.display = "block";
    }

    // üîµ Alterna campos do pagamento
    function mostrarMetodo() {
      const metodo = document.getElementById("metodo").value;
      document.getElementById("pag-cartao").style.display = metodo === "cartao" ? "block" : "none";
      document.getElementById("pag-pix").style.display = metodo === "pix" ? "block" : "none";
      document.getElementById("pag-boleto").style.display = metodo === "boleto" ? "block" : "none";
    }

    // üü¢ Finaliza compra
    function finalizarCompra(event) {
      event.preventDefault();

      const metodo = document.getElementById("metodo").value;
      const cupom = document.getElementById("cupom").value.trim().toUpperCase();
      const frete = document.getElementById("frete");
      const freteSelecionado = frete.options[frete.selectedIndex].text;

      let carrinho = JSON.parse(localStorage.getItem("carrinho") || "[]");

      const agrupado = {};
      carrinho.forEach(item => {
        if (!agrupado[item.nome]) agrupado[item.nome] = { ...item, quantidade: 1 };
        else agrupado[item.nome].quantidade++;
      });

      let itensTexto = "";
      for (let nome in agrupado) {
        const item = agrupado[nome];
        itensTexto += `${nome} (x${item.quantidade})\n`;
      }

      const totalFinal = totalCarrinho + valorFrete - desconto;
      const numeroPedido = "#BG" + new Date().toISOString().replace(/[-:.TZ]/g, "").slice(0, 14);
      const data = new Date();
      const dataFormatada = data.toLocaleDateString();
      const horaFormatada = data.toLocaleTimeString();

      const resumo = `‚úÖ Pedido realizado com sucesso!\n
N√∫mero do pedido: ${numeroPedido}
Data: ${dataFormatada} √†s ${horaFormatada}

Itens:
${itensTexto}
Cupom: ${cupom || "Nenhum"}
Frete: ${freteSelecionado}
Pagamento: ${metodo.charAt(0).toUpperCase() + metodo.slice(1)}
Total pago: R$ ${totalFinal.toFixed(2)}`;

      localStorage.removeItem("carrinho");
      document.getElementById("formPagamento").style.display = "none";
      document.getElementById("mensagem").innerText = resumo;
      document.getElementById("mensagem").style.whiteSpace = "pre-line";

      carregarCarrinho();
    }

    // üî¥ Carrega carrinho ao abrir a p√°gina
    carregarCarrinho();
  </script>
</body>
</html>
